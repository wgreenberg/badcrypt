import{b as k,t as P}from"../chunks/disclose-version.2DRxFBle.js";import{v as A,t as I,W as x,x as J,Z as s,X as o,Y as l,at as G,au as S,M as r,N as _}from"../chunks/runtime.CGM3PHJq.js";import{s as F}from"../chunks/render.DHDBtlUi.js";import{p as W,a as T,b,o as H}from"../chunks/index-client.NWmZA_4Q.js";import{r as h,s as X,b as Y,R as L,a as Z,c as Q,d as U}from"../chunks/crypto.CpbQ5cdD.js";import{d as j}from"../chunks/store.D0QdnE17.js";function V(e,a){var i=e.__className,t=O(a);A&&e.className===t?e.__className=t:(i!==t||A&&e.className!==t)&&(a==null?e.removeAttribute("class"):e.className=t,e.__className=t)}function O(e){return e??""}var n=(e=>(e[e.None=0]="None",e[e.Decrypt=1]="Decrypt",e[e.Encrypt=2]="Encrypt",e))(n||{});function $(e,a){a.keyPair&&navigator.clipboard.writeText(JSON.stringify(a.keyPair.publicKey))}var ee=P('<div><div class="publickey"><p>My public key</p> <input type="text"> <button>Copy Public Key</button></div> <div class="privatekey"><p>My private key</p> <input type="text"></div></div>');function te(e,a){I(a,!0);var i=ee(),t=o(i),v=s(o(t),2);h(v),x(()=>X(v,a.keyPair?JSON.stringify(a.keyPair.publicKey):"loading..."));var c=s(v,2);c.__click=[$,a],l(t);var p=s(t,2),y=s(o(p),2);h(y),l(p),l(i),x(()=>X(y,a.keyPair?a.keyPair.privateKey:"loading...")),k(e,i),J()}j(["click"]);function ae(e,a){const i=e.target.value;a(L.fromString(i))}var ie=P('<div><p>Public key of recipient</p> <input type="text"></div>'),re=P('<div><div><label><input type="radio">Encrypt</label> <label><input type="radio">Decrypt</label></div> <!></div>');function ne(e,a){I(a,!0);const i=[];let t=W(a,"operation",15),v=W(a,"recipientKey",15);var c=re(),p=o(c),y=o(p),d=o(y);h(d);var f;G(),l(y);var K=s(y,2),g=o(K);h(g);var m;G(),l(K),l(p);var E=s(p,2);T(E,()=>t()===n.Encrypt,D=>{var N=ie(),u=s(o(N),2);u.__input=[ae,v],l(N),k(D,N)}),l(c),x(()=>{f!==(f=n.Encrypt)&&(d.value=(d.__value=n.Encrypt)==null?"":n.Encrypt),m!==(m=n.Decrypt)&&(g.value=(g.__value=n.Decrypt)==null?"":n.Decrypt)}),Y(i,[],d,()=>(n.Encrypt,t()),t),Y(i,[],g,()=>(n.Decrypt,t()),t),k(e,c),J()}j(["input"]);function se(e,a,i,t,v,c){r(a)===n.Encrypt&&r(i)?(_(t,b(r(i).encryptString(r(v)))),navigator.clipboard.writeText(r(t))):r(a)===n.Decrypt?(_(t,b(r(c).decryptString(r(v)))),navigator.clipboard.writeText(r(t))):_(t,void 0)}var oe=P("<span><b>Copied result:</b> </span>"),le=P('<div><p>Secret:</p> <input type="text"> <button>GO</button> <!></div>'),ve=P('<div class="container svelte-1xupeis"><div class="opbox"><!> <!></div> <div class="keyzone svelte-1xupeis"><!> <button>Reroll</button></div> <img height="200" width="800" src="secretsafe.jpg"></div>');function be(e,a){I(a,!0);let i=S(void 0),t=S(b(n.None)),v=S(void 0),c=S(void 0),p=S("");H(()=>{let u=window.localStorage.getItem("rsaKeyPair");u?_(i,b(Z.fromString(u))):y()});function y(){_(i,b(Z.generate())),window.localStorage.setItem("rsaKeyPair",r(i).toString())}var d=ve(),f=o(d),K=o(f);ne(K,{get operation(){return r(t)},set operation(u){_(t,b(u))},get recipientKey(){return r(v)},set recipientKey(u){_(v,b(u))}});var g=s(K,2);T(g,()=>r(t)!==n.None,u=>{var M=le(),w=s(o(M),2);h(w);var z=s(w,2);z.__click=[se,t,v,c,p,i];var q=s(z,2);T(q,()=>r(c),R=>{var C=oe(),B=s(o(C));l(C),x(()=>F(B,` ${r(c)??""}`)),k(R,C)}),l(M),x(()=>U(w,"maxlength",r(t)===n.Encrypt?4:void 0)),Q(w,()=>r(p),R=>_(p,R)),k(u,M)}),l(f);var m=s(f,2),E=o(m);te(E,{get keyPair(){return r(i)}});var D=s(E,2);D.__click=y,l(m);var N=s(m,2);l(d),x(()=>V(N,`${(r(c)?"show":"hide")??""} svelte-1xupeis`)),k(e,d),J()}j(["click"]);export{be as component};
