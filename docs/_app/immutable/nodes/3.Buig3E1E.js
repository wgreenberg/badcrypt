import{b as m,t as P}from"../chunks/disclose-version.2DRxFBle.js";import{v as G,t as J,W as k,x as z,Z as v,X as n,Y as l,at as W,au as S,M as r,N as _}from"../chunks/runtime.CGM3PHJq.js";import{s as L}from"../chunks/render.DHDBtlUi.js";import{p as X,a as I,b as g,o as Q}from"../chunks/index-client.NWmZA_4Q.js";import{r as h,s as Y,b as Z,R as U,a as q,c as V,d as O}from"../chunks/crypto.CpbQ5cdD.js";import{d as A}from"../chunks/store.D0QdnE17.js";function $(e,i){var a=e.__className,t=ee(i);G&&e.className===t?e.__className=t:(a!==t||G&&e.className!==t)&&(i==null?e.removeAttribute("class"):e.className=t,e.__className=t)}function ee(e){return e??""}var s=(e=>(e[e.None=0]="None",e[e.Decrypt=1]="Decrypt",e[e.Encrypt=2]="Encrypt",e))(s||{});function te(e,i){i.keyPair&&navigator.clipboard.writeText(JSON.stringify(i.keyPair.publicKey))}var ie=P('<div><div class="publickey"><p>My public key</p> <fieldset role="group"><input type="text"> <input type="submit" value="Copy Public Key"></fieldset></div> <div class="privatekey"><p>My private key</p> <input type="text"></div></div>');function ae(e,i){J(i,!0);var a=ie(),t=n(a),o=v(n(t),2),p=n(o);h(p),k(()=>Y(p,i.keyPair?JSON.stringify(i.keyPair.publicKey):"loading..."));var u=v(p,2);u.__click=[te,i],l(o),l(t);var d=v(t,2),c=v(n(d),2);h(c),l(d),l(a),k(()=>Y(c,i.keyPair?i.keyPair.privateKey:"loading...")),m(e,a),z()}A(["click"]);function re(e,i){const a=e.target.value;i(U.fromString(a))}var ne=P('<div><p>Public key of recipient</p> <input type="text"></div>'),le=P('<div><div><label><input type="radio">Encrypt</label> <label><input type="radio">Decrypt</label></div> <!></div>');function se(e,i){J(i,!0);const a=[];let t=X(i,"operation",15),o=X(i,"recipientKey",15);var p=le(),u=n(p),d=n(u),c=n(d);h(c);var x;W(),l(d);var b=v(d,2),f=n(b);h(f);var E;W(),l(b),l(u);var K=v(u,2);I(K,()=>t()===s.Encrypt,w=>{var N=ne(),j=v(n(N),2);j.__input=[re,o],l(N),m(w,N)}),l(p),k(()=>{x!==(x=s.Encrypt)&&(c.value=(c.__value=s.Encrypt)==null?"":s.Encrypt),E!==(E=s.Decrypt)&&(f.value=(f.__value=s.Decrypt)==null?"":s.Decrypt)}),Z(a,[],c,()=>(s.Encrypt,t()),t),Z(a,[],f,()=>(s.Decrypt,t()),t),m(e,p),z()}A(["input"]);function ve(e,i,a,t,o,p){r(i)===s.Encrypt&&r(a)?(_(t,g(r(a).encryptString(r(o)))),navigator.clipboard.writeText(r(t))):r(i)===s.Decrypt?(_(t,g(r(p).decryptString(r(o)))),navigator.clipboard.writeText(r(t))):_(t,void 0)}var pe=P("<span><b>Copied result:</b> </span>"),oe=P('<div><p>Secret:</p> <fieldset role="group"><input type="text"> <input type="submit" value="GO"></fieldset> <!></div>'),ce=P('<main><div class="container svelte-1rn1djc"><div class="opbox"><!> <!></div> <div class="keyzone svelte-1rn1djc"><!> <button>Reroll</button></div> <img height="200" width="800" src="secretsafe.jpg"></div></main>');function be(e,i){J(i,!0);let a=S(void 0),t=S(g(s.None)),o=S(void 0),p=S(void 0),u=S("");Q(()=>{let y=window.localStorage.getItem("rsaKeyPair");y?_(a,g(q.fromString(y))):d()});function d(){_(a,g(q.generate())),window.localStorage.setItem("rsaKeyPair",r(a).toString())}var c=ce(),x=n(c),b=n(x),f=n(b);se(f,{get operation(){return r(t)},set operation(y){_(t,g(y))},get recipientKey(){return r(o)},set recipientKey(y){_(o,g(y))}});var E=v(f,2);I(E,()=>r(t)!==s.None,y=>{var M=oe(),R=v(n(M),2),D=n(R);h(D);var B=v(D,2);B.__click=[ve,t,o,p,u,a],l(R);var F=v(R,2);I(F,()=>r(p),C=>{var T=pe(),H=v(n(T));l(T),k(()=>L(H,` ${r(p)??""}`)),m(C,T)}),l(M),k(()=>O(D,"maxlength",r(t)===s.Encrypt?4:void 0)),V(D,()=>r(u),C=>_(u,C)),m(y,M)}),l(b);var K=v(b,2),w=n(K);ae(w,{get keyPair(){return r(a)}});var N=v(w,2);N.__click=d,l(K);var j=v(K,2);l(x),l(c),k(()=>$(j,`${(r(p)?"show":"hide")??""} svelte-1rn1djc`)),m(e,c),z()}A(["click"]);export{be as component};
