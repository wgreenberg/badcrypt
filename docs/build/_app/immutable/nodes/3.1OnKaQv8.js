import{b as m,t as P}from"../chunks/disclose-version.2DRxFBle.js";import{v as A,t as I,W as k,x as J,Z as v,X as n,Y as s,at as G,au as S,M as r,N as _}from"../chunks/runtime.CGM3PHJq.js";import{s as L}from"../chunks/render.DHDBtlUi.js";import{p as W,a as T,b as g,o as Q}from"../chunks/index-client.NWmZA_4Q.js";import{r as h,s as X,b as Y,R as U,a as Z,c as V,d as O}from"../chunks/crypto.CpbQ5cdD.js";import{d as j}from"../chunks/store.D0QdnE17.js";function $(e,i){var a=e.__className,t=ee(i);A&&e.className===t?e.__className=t:(a!==t||A&&e.className!==t)&&(i==null?e.removeAttribute("class"):e.className=t,e.__className=t)}function ee(e){return e??""}var l=(e=>(e[e.None=0]="None",e[e.Decrypt=1]="Decrypt",e[e.Encrypt=2]="Encrypt",e))(l||{});function te(e,i){i.keyPair&&navigator.clipboard.writeText(JSON.stringify(i.keyPair.publicKey))}var ie=P('<div><div class="publickey"><p>My public key</p> <fieldset role="group"><input type="text"> <input type="submit" value="Copy Public Key"></fieldset></div> <div class="privatekey"><p>My private key</p> <input type="text"></div></div>');function ae(e,i){I(i,!0);var a=ie(),t=n(a),o=v(n(t),2),p=n(o);h(p),k(()=>X(p,i.keyPair?JSON.stringify(i.keyPair.publicKey):"loading..."));var u=v(p,2);u.__click=[te,i],s(o),s(t);var d=v(t,2),c=v(n(d),2);h(c),s(d),s(a),k(()=>X(c,i.keyPair?i.keyPair.privateKey:"loading...")),m(e,a),J()}j(["click"]);function re(e,i){const a=e.target.value;i(U.fromString(a))}var ne=P('<div><p>Public key of recipient</p> <input type="text"></div>'),se=P('<div><div><label><input type="radio">Encrypt</label> <label><input type="radio">Decrypt</label></div> <!></div>');function le(e,i){I(i,!0);const a=[];let t=W(i,"operation",15),o=W(i,"recipientKey",15);var p=se(),u=n(p),d=n(u),c=n(d);h(c);var x;G(),s(d);var b=v(d,2),f=n(b);h(f);var E;G(),s(b),s(u);var K=v(u,2);T(K,()=>t()===l.Encrypt,w=>{var N=ne(),z=v(n(N),2);z.__input=[re,o],s(N),m(w,N)}),s(p),k(()=>{x!==(x=l.Encrypt)&&(c.value=(c.__value=l.Encrypt)==null?"":l.Encrypt),E!==(E=l.Decrypt)&&(f.value=(f.__value=l.Decrypt)==null?"":l.Decrypt)}),Y(a,[],c,()=>(l.Encrypt,t()),t),Y(a,[],f,()=>(l.Decrypt,t()),t),m(e,p),J()}j(["input"]);function ve(e,i,a,t,o,p){r(i)===l.Encrypt&&r(a)?(_(t,g(r(a).encryptString(r(o)))),navigator.clipboard.writeText(r(t))):r(i)===l.Decrypt?(_(t,g(r(p).decryptString(r(o)))),navigator.clipboard.writeText(r(t))):_(t,void 0)}var pe=P("<span><b>Copied result:</b> </span>"),oe=P('<div><p>Secret:</p> <fieldset role="group"><input type="text"> <input type="submit" value="GO"></fieldset> <!></div>'),ce=P('<main><div class="container svelte-1fnq4sz"><div class="opbox"><!> <!></div> <div class="keyzone svelte-1fnq4sz"><!> <button>Reroll</button></div> <img height="200" width="800" src="secretsafe.jpg"></div></main>');function be(e,i){I(i,!0);let a=S(void 0),t=S(g(l.None)),o=S(void 0),p=S(void 0),u=S("");Q(()=>{let y=window.localStorage.getItem("rsaKeyPair");y?_(a,g(Z.fromString(y))):d()});function d(){_(a,g(Z.generate())),window.localStorage.setItem("rsaKeyPair",r(a).toString())}var c=ce(),x=n(c),b=n(x),f=n(b);le(f,{get operation(){return r(t)},set operation(y){_(t,g(y))},get recipientKey(){return r(o)},set recipientKey(y){_(o,g(y))}});var E=v(f,2);T(E,()=>r(t)!==l.None,y=>{var M=oe(),R=v(n(M),2),D=n(R);h(D);var B=v(D,2);B.__click=[ve,t,o,p,u,a],s(R);var F=v(R,2);T(F,()=>r(p),q=>{var C=pe(),H=v(n(C));s(C),k(()=>L(H,` ${r(p)??""}`)),m(q,C)}),s(M),k(()=>O(D,"maxlength",r(t)===l.Encrypt?4:void 0)),V(D,()=>r(u),q=>_(u,q)),m(y,M)}),s(b);var K=v(b,2),w=n(K);ae(w,{get keyPair(){return r(a)}});var N=v(w,2);N.__click=d,s(K);var z=v(K,2);s(x),s(c),k(()=>$(z,`${(r(p)?"show":"hide")??""} svelte-1fnq4sz`)),m(e,c),J()}j(["click"]);export{be as component};
